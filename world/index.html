<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>world</title>
    <meta name="description" content="world">
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.slim.js"></script>
    <script>

    let msg;
    let msg2;

    let socket = io.connect(window.location.origin);
    socket.on('mysocket', function(data) {
    msg = parseFloat(data[1]);
    msg2 = parseFloat(data[2]);
    
    });

    function map_range(value, low1, high1, low2, high2) {
    return low2 + (high2 - low2) * (value - low1) / (high1 - low1);
    }
    
    AFRAME.registerComponent('log', {
    schema: {type: 'string'},
    init: function () {
      let el = this.el; 
    },

    tick: function () {
    // Don't call query selector in here, query beforehand.
    let val = map_range(msg, 0, 1, -10, 10)
    let val2 = map_range(msg2, 0, 1, -10, 10)
    console.log(parseInt(val));
    this.el.setAttribute('position', {
      x: val,
      y: val2,
      z: -5
    });
    }
    });
    </script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <img id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg" crossorigin="anonymous">
        <img id="skyTexture" src="https://cdn.aframe.io/a-painter/images/sky.jpg" crossorigin="anonymous">
      </a-assets>

      <!-- Primitives. -->
      <a-box position="-1 0.6 -3" rotation="0 45 0" color="#4CC3D9" log></a-box>
      <a-sphere position="0 1.35 -5" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-cylinder position="1 0.85 -3" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
      <a-plane position="0 .1 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>


      <!-- Background sky. -->
      <a-sky height="2048" radius="30" src="#skyTexture" theta-length="90" width="2048"></a-sky>

      <!-- Ground. -->
      <a-circle src="#groundTexture" rotation="-90 0 0" radius="32"></a-circle>

      
    </a-scene>
  </body>
</html>
